[toc]

# SPA和SSR介绍

## 一. SPA(单页面富应用)

- SPA(单页面富应用), 主要包含一个文件index.html, 其他需要加载时再引用

  - SPA应用默认只返回一个空的HTML页面. 如: body只有`<div id="app" ></div>`, 后续浏览器再请求html上的脚本和一些静态资源
  - 整个应用程序的内容都是通过JavaScript动态加载的, 包括应用程序的逻辑, UI以及服务器通信相关的所有数据

- **缺点**: 

  - 难以进行SEO(搜索引擎优化search engine optimization), 因为单个html文件可爬取的数据较少
  - 首屏的渲染速度较慢
    - 需要先下载js文件, 浏览器再执行js代码, 才能被显示
  - 不利于构建复杂的项目, 复杂的Web应用程序的大文件可能变得难以维护

- **优点**:

  - 只需要请求一次
    - SPA应用程序只需要在第一次请求时加载页面, 页面的切换不需要重新加载(使用前端路由), 而传统的Web应用程序必须在每次请求时都得加载页面, 需要花费更多的时间. 因此, SPA页面加载速度要比传统的web应用程序更快

  - 更好的用户体验:
    - SPA提供类似于桌面或移动应用程序的体验. 用户切换页面不必重新加载新页面
    - 切换页面只是内容发生了变化, 页面并没有重新加载, 从而使体验变得更加流畅

  - 可以轻松的构建功能丰富的Web应用程序

  

![client-side-rendering-2x](.\图片\client-side-rendering-2x.png)

## 二. 搜索引擎优化(SEO)

- 语义性HTML标记
  - 标题用<h1>, 一个页面只有一个; 副标题使用<h2>到<h6>
  - 不过度使用h标签, 多次使用不会增加SEO
  - 段落用<p>, 列表用<ul>, 并且<li>只放在ul中
- 每个页面需包含: 标题(title) + 内部链接(a)
  - 每个页面对应的title, 同一网站所有页面都有内链可以指向首页
- 确保链接可供抓取
- meta标签优化: 设置description keywords
- 文本标记和img
  - 比如<b>和<strong>加粗文本的标签, 爬虫也会关注到该内容
  - img标签添加alt属性, 图片加载失败时, 爬虫会抓取alt内容
- robots.txt文件: 规定爬虫可访问网站上的哪些网址
- sitemap.xml站点地图: 在站点地图列出所有的网页, 确保爬虫不会漏掉某些网页



## 三. SSG(静态站点生成)

- SSG(静态站点生成), 是预先生成好的静态网站
  - SSG应用一般在构建阶段就确定了网站的内容
  - **如果网站的内容需要更新, 必须重新部署和构建**
- **优点:**
  - 访问速度非常快, 因为每个页面都是在构建阶段就提前生成好的
  - 直接给浏览器返回静态的HTML, 也有利于SEO
- **缺点:**
  - 页面都是静态的, 不利于展示实时性的内容, 实时性的更适合SSR
  - 如果站点内容更新了, 那必须重新再次构建和部署



## 四. SSR(服务器端渲染)

- SSR(服务器端渲染), 在服务器端渲染页面, 并将渲染好的HTML返回给浏览器呈现
  - 用户请求的SSR页面会先在服务器端进行渲染, 然后将渲染好的页面, 返回给浏览器呈现

- **优点:**

  - **更快的首屏渲染速度**
    - 由上图可见, 即使此时只有静态的HTML, 但页面已经可见, **客户端渲染需要等到所有的文件都被下载和执行之后才能可见**
    - SSR应用程序在Hydration后依然可以保留Web应用程序的交互性, 比如: 前端路由, 响应式数据, 虚拟DOM

  - **更好的SEO**
    - 爬虫更擅长爬取静态的HTML页面, 服务器直接返回的是一个静态的HTML给浏览器,
    - 这样有利于爬虫快速的抓取网页内容

- **缺点:**
  - SSR通常需要对服务器进行更多的API调用, 以及服务器端渲染需要消耗更多的服务器资源, **成本高**
  - 增加了一定的开发成本, 需要分辨在浏览器运行的代码和服务器端运行的
  - SSR配置站点的缓存通常会比SPA站点要更加复杂

### 1. 同构

- 同构: 一套代码既可以在服务端运行又可以在客户端运行, 这就是同构应用

- 同构时一种SSR的形态, 是现代SSR的一种表现形式

  - 当用户发出请求时, 现在服务器通过SSR渲染出首页的内容

  - 但是对应的代码同样可以在客户端被执行

  - 执行的目的包括事件绑定等以及其他页面切换时也可以在客户端被渲染

### 2. hydration

- Node环境运行后生成的HTML页面结构,输出出来时**只是一串字符串**, 仅仅用来展示,
- 浏览器执行后, 会将其中的**脚本(script)**什么的注入到这个结构中(不会再发送请求, 因为代码已经被下载下来了), 使这个页面可以进行交互(类似SPA)![Snipaste_2022-12-30_18-44-20](C:\Users\zZOMZz\Desktop\Typora笔记\临时待整理\图片\Snipaste_2022-12-30_18-44-20.png)

![server-side-rendering-2x](.\图片\server-side-rendering-2x.png)



### 3. SSR的应用场景

- Saas产品, 如: 电子邮箱网站, 在线游戏
- 门户网站, 电子商务, 零售网站
- 单个页面, 静态页面, 文档类网站